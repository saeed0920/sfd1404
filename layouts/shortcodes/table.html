{{ $donations := append site.Data.donations site.Data.donations_static }}
{{ $donationsTotalInTomans := 0.0 }}
{{ range $donations }}
  {{ $donationsTotalInTomans = add $donationsTotalInTomans (div (float .amount) 10) }}
{{ end }}

{{ $expensesTotalInTomans := 0.0 }}
{{ range site.Data.expenses }}
  {{ $expensesTotalInTomans = add $expensesTotalInTomans (div (float .amount) 10) }}
{{ end }}

{{ $percent := 0.0 }}
{{ if gt $expensesTotalInTomans 0 }}
  {{ $percent = math.Min 100 (mul (div $donationsTotalInTomans $expensesTotalInTomans) 100) }}
{{ end }}

<div style="text-align: center; margin-bottom: 2rem; margin-top : 4rem;">
  <h1 style="font-size: 1.8rem; font-weight: 700; color: #1e293b;">Ú¯Ø²Ø§Ø±Ø´ Ù…Ø§Ù„ÛŒ</h1>
  <p style="font-size: 1rem; color: #4b5563; max-width: 600px; margin: 0.5rem auto;">
    Ø¨Ø±Ú¯Ø²Ø§Ø±ÛŒ Ø¬Ø´Ù† Ø±ÙˆØ² Ø¢Ø²Ø§Ø¯ÛŒ Ù†Ø±Ù…â€ŒØ§ÙØ²Ø§Ø± Ø¨Ø§ Ø­Ù…Ø§ÛŒØª Ø§Ø±Ø²Ø´Ù…Ù†Ø¯ Ø¬Ø§Ù…Ø¹Ù‡ Ù…Ù…Ú©Ù† Ø´Ø¯. Ø¯Ø± Ø±Ø§Ø³ØªØ§ÛŒ Ø´ÙØ§ÙÛŒØª Ùˆ Ù‚Ø¯Ø±Ø¯Ø§Ù†ÛŒØŒ Ú¯Ø²Ø§Ø±Ø´ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ Ùˆ Ø­Ù…Ø§ÛŒØª Ù‡Ø§ Ø¨Ù‡ Ø´Ø±Ø­ Ø²ÛŒØ± Ø§Ø±Ø§Ø¦Ù‡ Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯.
  </p>
</div>

<div class="financial-card">
  <h2>  ÙˆØ¶Ø¹ÛŒØª Ú©Ù„ÛŒ ğŸ’°</h2>

  <div class="financial-bar">
    <div class="donations-bar" style="position: absolute; left:0; top:0; height:100%; background:#22c55e; width: {{ printf "%.0f" $percent }}%; border-radius: 8px 0 0 8px; transition: width 0.5s ease;"></div>
  </div>

  <div class="summary">
    <p>Ø¯Ø±Ø¢Ù…Ø¯ Ú©Ù„: <script>document.write(Number({{ printf "%.0f" $donationsTotalInTomans }}).toLocaleString('fa-IR') + ' ØªÙˆÙ…Ø§Ù†');</script></p>
    <p>Ù‡Ø²ÛŒÙ†Ù‡ Ú©Ù„: <script>document.write(Number({{ printf "%.0f" $expensesTotalInTomans }}).toLocaleString('fa-IR') + ' ØªÙˆÙ…Ø§Ù†');</script></p>
    <p>Ù…Ø§Ù†Ø¯Ù‡: <script>document.write(Number({{ printf "%.0f" (sub $donationsTotalInTomans $expensesTotalInTomans) }}).toLocaleString('fa-IR') + ' ØªÙˆÙ…Ø§Ù†');</script></p>
  </div>
</div>

<div class="cards-container">
  {{/* donations */}}
  <div class="cards-container_card">
    <h3>Ø­Ù…Ø§ÛŒØª Ù‡Ø§ ğŸ“¥ </h3>
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</th>
            <th>ØªØ§Ø±ÛŒØ® Ù¾Ø±Ø¯Ø§Ø®Øª</th>
            <th>ØªÙˆØ¶ÛŒØ­Ø§Øª</th>
            <th>Ù…Ø¨Ù„Øº</th>
          </tr>
        </thead>
        <tbody>
          {{ if $donations }}
            {{ range $i, $d := $donations }}
              <tr>
                <td data-label="#"> {{ add $i 1 }}</td>
                <td data-label="Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ">{{ $d.donator_name }}</td>
                <td data-label="ØªØ§Ø±ÛŒØ® Ù¾Ø±Ø¯Ø§Ø®Øª">{{ $d.date }}</td>
                <td data-label="ØªÙˆØ¶ÛŒØ­Ø§Øª">{{ $d.message }}</td>
                <td data-label="Ù…Ø¨Ù„Øº">
                  <script>
                    document.write(Number({{ div (float $d.amount) 10 }}).toLocaleString('fa-IR') + ' ØªÙˆÙ…Ø§Ù†');
                  </script>
                </td>
              </tr>
            {{ end }}
          {{ else }}
            <tr class="empty-row">
              <td colspan="5">Ø®Ø§Ù„ÛŒ</td>
            </tr>
          {{ end }}
        </tbody>
      </table>
    </div>
  </div>

  {{/* expenses */}}
  <div class="cards-container_card">
    <h3> Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ ğŸ“¤</h3>
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Ø¹Ù†ÙˆØ§Ù†</th>
            <th>ØªÙˆØ¶ÛŒØ­Ø§Øª</th>
            <th>Ù…Ø¨Ù„Øº</th>
          </tr>
        </thead>
        <tbody>
          {{ if site.Data.expenses }}
            {{ range $i, $e := site.Data.expenses }}
              <tr>
                <td data-label="#"> {{ add $i 1 }}</td>
                <td data-label="Ø¹Ù†ÙˆØ§Ù†">{{ $e.title }}</td>
                <td data-label="ØªÙˆØ¶ÛŒØ­Ø§Øª">{{ $e.description }}</td>
                <td data-label="Ù…Ø¨Ù„Øº">
                  <script>
                    document.write(Number({{ div (float $e.amount) 10 }}).toLocaleString('fa-IR') + ' ØªÙˆÙ…Ø§Ù†');
                  </script>
                </td>
              </tr>
            {{ end }}
          {{ else }}
            <tr class="empty-row">
              <td colspan="4">Ø®Ø§Ù„ÛŒ</td>
            </tr>
          {{ end }}
        </tbody>
      </table>
    </div>
  </div>

</div>
